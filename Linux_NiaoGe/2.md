# 《鸟哥的Linux私房菜》读书笔记(二)

## 6 Linux文件与目录管理

### 6.1 目录与路径

特殊目录：  

- [ . ] 当前目录
- [ .. ] 上层目录
- [ - ] 前一个工作目录
- [ ~ ] 目前使用者的/home
- [ ~xxx ] xxx的/home
- [  ] (对，什么也没有) == ~

常见处理目录的命令：

- [ cd ] 切换(善用[Tab]补全目录)
- [ pwd ] 显示当前目录的绝对路径(默认考虑链接)(print working directory)(-p 依次建立所有沿途的目录)
- [ mkdir ] 建立目录 (-m 设置权限)
- [rmdir ] 删除目录 (-p 依次删除沿途**空目录**)

关于$PATH：

> echo $XXX 表示显示XXX**这个变量的值**

e.g. 为什么在任何地方执行ls都能找到命令？  
因为PATH这个环境变量里设置了/bin这个目录，系统会依次在环境变量中找你输入的命令  
如何添加环境变量？  
e.g. 加入/root这个目录：  

    PATH="${PATH}:/root"

### 6.2 文件与目录管理

**ls：** ll == ls -l  

**cp：** 默认是不会复制权限等信息的，需要read权限，可以复制多个文件到最后的目标文件夹  

- -i  如果遇到重名会询问
- -a  复制所有信息
- -r  递归复制
- -p  连同文件属性一起复制
- -s  创建快捷方式
- -u  只在要复制的文件更“新”的时候才复制

**rm**  

- -f  忽略不存在的文件，不发出警告
- -I  交互模式，会询问
- -r  递归进行！！危！！
- rmdir  删除目录

**touch**：产生一个空文件/或者修改某一个文件的时间属性  

**mv**：见[ cp ]，可用于重命名

### 6.3 文件内容的查看

- **cat**：从第一行开始显示  
- **tac**：从最后一行显示  
- **nl**：显示行号(==cat -n)  
- **more**：一页一页的显示内容(较为常用，输入/xxx来找字符串，按空格翻页)  
- **less**：比more更好月，可以用pg up/pg dn  
- **head**：只看前面几行  
- **tail**：只看后面几行  
- **od**：二进制形式读取  

### 6.4 文件权限

#### 6.4.1 默认属性：umask

默认权限：

- 文件：666
- 目录：777

命令行输入umask[-S]：显示4个数字，除了第一个数字，依次代表ugo**被从默认权限李拿掉**的权限  
输入umask xxx来修改  

#### 6.4.2 隐藏属性

**stat xxx**：查看隐藏属性  
**chattr [-+=] xxx**：改变文件的参数

- -a  设置后他只能添加数据（只有root可以设置这个）
- -i  可以让文件[不能删除、改名、设置链接也无法写入或者新增数据（只有root可以设置这个）

**lsattr**：显示隐藏属性  

#### 6.4.3 文件特殊权限

##### SUID

当s这个标志出现在文件拥有者的x权限上时，称他获取了SUID的特殊权限，基本上SUID有这样的限制和功能：

- 仅对二进制文件有效
- 执行者需要对该程序有x的权限
- 本权限仅在执行中有效
- 执行者将拥有该程序拥有者的权限
- 不能用在shell脚本上/目录上

##### SGID

当s这个标志出现在用户组的x权限上时，称他获取了SGID的特殊权限  

对于文件：  

- 对二进制程序有用
- 执行者需要有x权限
- 执行者在执行过程中会获得用户组的支持

对于目录：  

- 用户要有r+x才能进入
- 用户在此目录下的有效用户组将变成该目录的用户组
- 若该用户在此目录下具有w权限，则他新建的文件的用户组为目录的用户组

##### SBIT

只对目录有效：将目录设为SBIT意味着进来的人只能写入/删除自己的文件，动不了别人的东西  

##### 如何设置

在正常权限前加一个数字：

- 4  SUID(u+s)
- 2  SGID(g+s)
- 1  SBIT(o+t)

e.g.  

    chmod 4755 filename

将file改成[-rwsr-xr-x]，即SUID  

    chmod g+s test

将test改成SGID  

#### 6.4.4 file

    file filename

显示filename的文件基本信息  

### 6.5 命令与文件的查找

#### 6.5.1 脚本文件的查找

**which**：查找命令所在的路径(在PATH里找)  

#### 6.5.2 查找文件

##### whereis

在特定目录下查找二进制文件

##### locate

使用前要[sudo updatedb]  
可以找任何文件，而且不用全称  

##### find

加上详细绝对路径，可以加 [-mtime 4]来根据时间找  

- +4：4天前
- 4：第四天
- -4：最近4天

还可以加正则表达式  