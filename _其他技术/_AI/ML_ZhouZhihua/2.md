# 周志华《机器学习》笔记(二)

> 关键词: AI, 读书笔记

## 2 模型评估与选择

##### t 检验云云

？?不知道下面这段对不对。。。

- 假设：A，B 是同一个分布（$A～N(\mu_0,?)$，B 是已知分布）
- 检验：取样出手头有的样本的概率大不大，根据直觉，这个概率应该和以下因素有关：
  - 样本平均值$\bar{x}$
  - 样本方差$s$
  - 采样数$n$

在用样本估计整体时，研究样本的**平均数的分布**，这个分布（记为分布 S---我随便取得名字）是一个[ 方差是总体分布方差的$1/\sqrt{n},n$为样本量，期望与总体期望相同 ]的正态分布（_p.s. 抽样次数足够多才有这个结论，但如果原分布是正态分布就没有任何限制_）

综上，得出以下统计量：

$$
\tau = \frac{\sqrt{n}\cdot|\bar{x}-\mu_0|}{s}
$$

这个量服从自由度为 n-1 的 t 分布（n 趋于无穷时为正态分布），代表的是[ 假设母体 A 服从 B 分布，对它抽样应该得到的平均数分布 ]，再看手头的数据，他从这个分布里 sample 出来的概率有多大呢（用$\tau$反映差距），再把这个结果和置信区间比较来决定是否接受它。

具体参见：
[t 检验(知乎,啤酒)](https://www.zhihu.com/answer/296723303)|
[t 检验(知乎,情书)](https://www.zhihu.com/answer/589141978)

#### 2.4.2 交叉验证 t 检验

**目标**：判断两个模型性能差异大不大，如果大就取用平均误差小的那个  
**思路**：先对两个模型喂入一样的数据（用 k 折的方法），对他们表现的差异进行 t 检验  
**问题**：训练集有一定的重叠，使得测试错误率并不独立（每个测试集都被使用了 k-1 次），会高估假设成立的概率，我们采用"5\*2 交叉检验"  
**做法**：做 5 次 2 折交叉检验，仅计算第一次二折上的平均值，计算每次二折的方差

#### 2.4.3 McNemar 检验

| A\B  |   正确   |   错误   |
| :--: | :------: | :------: |
| 正确 | $e_{00}$ | $e_{01}$ |
| 错误 | $e_{10}$ | $e_{11}$ |

假设两个模型性能相同，则应有$e_{01}=e_{10}$，变量$|e_{01}-e_{10}|$应该服从正态分布，均值为 1，方差为$e_{01}+e_{10}$，因此变量

$$
\tau_{\chi^2}=\frac{(|e_{01}-e_{10}|-1)^2}{e_{01}+e_{10}}
$$

服从自由度为 1 的卡方分布?？。给定显著度，当上述变量小于临界值时。不能拒绝假设，否则认为两个模型有显著差异，选取平均值较小的那个

#### 2.4.4 Friedman 检验和 Nemenyi 后续检验

当一个数据集上有多个模型要检验的时候，固然可以用前述方法逐对检验，但是更快的方法是**基于算法排序的 Friedman 检验**

考虑我们在$N$个数据集上比较$k$个模型。首先对他们各自进行性能评估（用前述方法），然后在每一个数据集上对性能排序，对所有模型按表现进行排序，并根据他们的排序结果赋予每个模型一个*序值*（第一名得 1 分，第 3 名 3 分，并列就平分序值之和）。

先看看这些模型能不能看成表现相同  
令$r_i$表示第$i$个算法的**平均序值**，则$r_i$服从正态分布，其均值和方差分别为$(k+1)/2,\space (k^2-1)/12$，变量

$$
\tau_{\chi^2}=\frac{k-1}{k}\cdot\frac{12N}{k^2-1}\cdot\displaystyle\sum_{i=1}^{k}(r_i-\frac{k+1}{2})^2
$$

在$k，N$都较大的时候服从自由度为$k-1$的$\chi^2$分布  
然而上述模型过于保守，现在通常用变量

$$
\tau_F=\frac{(N-1)\cdot \tau_{\chi^2}}{N\cdot(k-1)-\tau_{\chi^2}}
$$

其中$\tau_{\chi^2}$由上上式得，$\tau_F$服从自由度为$k-1$和$(k-1)\cdot(N-1)$的 F 分布

若“所有模型性能相同”这个假设被拒绝，说明模型性能显著不同，此时进行后续检验，常用的有 Nemenyi 后续检验  
Nemenyi 检验计算出平均序值差别的临界值域：

$$
CD=q_\alpha\sqrt{\frac{k(k+1)}{6N}}
$$

若两个模型平均序值之差超出临界值，则以相应的置信度拒绝“两个模型性能相同“这个假设

画出 Friefman 检验图：横轴为平均序值。纵轴是不同算法，并在水平方向上以每一个均值为中心，向左右 CD 范围内画线段，线段在竖直方向上有重叠的模型认为是相近的模型，其他按均值排序。

### 2.5 偏差与方差

- **偏差**(bias)：度量了模型的预测和真实结果间的差别，刻画模型本身的拟合能力
- **方差**(var)：度量了同样大小的训练集的变动导致的性能变化，刻画了数据扰动造成的影响
- **噪声**：表达了在当前任务上任何模型的误差下界，刻画了问题本身的难度

bias v.s. variance ：要在过拟合，欠拟合之间找到一个平衡

---
