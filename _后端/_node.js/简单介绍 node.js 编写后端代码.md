# [ç§‘æ™®] node.js ç¼–å†™åç«¯ä»£ç 

> å…³é”®è¯: Node.js, æŒ‡åŒ—

## node.js æ˜¯ä»€ä¹ˆ

è¿™å°±å¾—ä» js çš„èµ·æºè®²èµ·...ä¼—æ‰€å‘¨çŸ¥, js æ˜¯ä¸€é—¨ç”¨æ¥æ“ä½œç½‘é¡µçš„è¯­è¨€. js çš„è®¾è®¡ç›®æ ‡å°±æ˜¯è®©ç½‘é¡µèƒ½åŠ¨èµ·æ¥. æ—¢ç„¶è¦æ“çºµç½‘é¡µ, é‚£å°±å¿…é¡»**æœ‰**ç½‘é¡µ, æ‰€æ‰€ä»¥åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´é‡Œ js éƒ½å¿…é¡»åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ, æ¯ä¸ªæµè§ˆå™¨éƒ½é…æœ‰ js çš„è§£é‡Šå™¨ä»¥æ‰§è¡Œ js ä»£ç , è¿™ä¹Ÿè®© js æˆä¸ºäº†ä¸–ç•Œä¸Šè£…æœºé‡æœ€å¤§çš„è¯­è¨€ä¹‹ä¸€(å°çµé€šéƒ½èƒ½ä¸Šç½‘, ä¸ä¼šæœ‰ç”µå­è®¾å¤‡ä¸èƒ½ç”¨æµè§ˆå™¨å§ ğŸ˜…)

åœ¨**å‰ç«¯**è¿™ä¸ªæ¦‚å¿µå´›èµ·å‰, æ²¡æœ‰*å‰ç«¯å·¥ç¨‹å¸ˆ*è¿™ç§è¯´æ³•, ç½‘é¡µéƒ½æ˜¯é€šè¿‡åç«¯ç”¨ä¸€ç§ä¸ä¼˜é›…çš„æ–¹å¼ç¼–å†™çš„(åç»­ä¼šå±•ç¤º), è€Œå½“**å‰ç«¯**æ¦‚å¿µå´›èµ·å, æ¶Œç°äº†ä¸€å¤§æ‰¹å‰ç«¯å·¥ç¨‹å¸ˆ. ä½†æƒ³åˆ¶ä½œä¸€ä¸ªç½‘é¡µ, å¿…é¡»æ—¢æœ‰å‰ç«¯åˆæœ‰åç«¯, ä¸ºäº†~~å‹æ¦¨å‘˜å·¥~~èŠ‚çœäººåŠ›æˆæœ¬, å‡ºç°äº†å¯¹å…¨æ ˆå·¥ç¨‹å¸ˆçš„éœ€æ±‚.

ä½†æ˜¯, å‰ç«¯ä½¿ç”¨çš„æ˜¯ js è¯­è¨€, åç«¯ä½¿ç”¨çš„æ˜¯ go, java, python ç­‰è¯­è¨€, è¯­è¨€ä¸é€š, æƒ³æˆä¸ºå…¨æ ˆå·¥ç¨‹å¸ˆçš„å­¦ä¹ æˆæœ¬è¾ƒé«˜, ä¸€å®šç¨‹åº¦ä¸Šé˜»æ­¢äº†å…¨æ ˆå·¥ç¨‹å¸ˆçš„åŸ¹å…». é‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è®©å‰åç«¯ç»Ÿä¸€è¯­è¨€, è‡³å°‘å‡å»å­¦ä¹ è¯­è¨€çš„æˆæœ¬!

äºæ˜¯ [node.js](https://nodejs.org/zh-cn/) åº”è¿è€Œç”Ÿ, è¿™æ˜¯ä¸€ä¸ªè£…åœ¨ç”µè„‘ä¸Šçš„ç¨‹åº, å¯ä»¥**åœ¨æµè§ˆå™¨å¤–è§£æ js**, å¹¶**è°ƒç”¨ä¸€äº›ç³»ç»ŸåŠŸèƒ½**å’Œ**æ“ä½œæ•°æ®åº“**, æœ‰äº†å®ƒ, æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ ---- js, æ¥å¿«ä¹çš„ç¼–å†™åç«¯ä»£ç å•¦!

## å®‰è£… node

è§[èœé¸Ÿæ•™ç¨‹](https://www.runoob.com/nodejs/nodejs-install-setup.html)

## ç¼–å†™åç«¯ä»£ç 

### ä»æœåŠ¡å™¨æ˜¯ä»€ä¹ˆè®²èµ·

**æœåŠ¡å™¨å°±æ˜¯ä¸€å°ç”µè„‘**, åªæ˜¯ä¸èƒ½æ‰“æ¸¸æˆ, ä¸èƒ½çœ‹è§†é¢‘, ä¸èƒ½å¿«ä¹ happy, å®ƒçš„å”¯ä¸€ç›®çš„å°±æ˜¯**æä¾›æœåŠ¡**, å¦‚è®©å¤§å®¶å¯ä»¥è®¿é—®åˆ°ç½‘é¡µ, å¯ä»¥è¿›è¡Œè¾ƒå¼ºçš„è®¡ç®—èƒ½åŠ›æ¥è®­ç»ƒ ai ç­‰

æœåŠ¡å™¨(å…¶å®ä»»ä½•ç”µè„‘éƒ½æœ‰)æœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§: ip åœ°å€ å’Œ ç«¯å£å·

é€šè¿‡ _ip åœ°å€_ å¯ä»¥å”¯ä¸€ç¡®å®šä¸€å°æœåŠ¡å™¨, é€šè¿‡ _ç«¯å£å·_ å¯ä»¥å”¯ä¸€ç¡®å®šæœåŠ¡å™¨ä¸Šè¿è¡Œçš„ä¸€ä¸ªæœåŠ¡.

> **IP åœ°å€**ï¼ˆè‹±è¯­ï¼šIP Addressï¼Œå…¨ç§° Internet Protocol Addressï¼‰ï¼Œåˆè¯‘ä¸ºç½‘é™…åè®®åœ°å€ã€äº’è”ç½‘åè®®åœ°å€ã€‚å½“è®¾å¤‡è¿æ¥ç½‘ç»œï¼Œè®¾å¤‡å°†è¢«åˆ†é…ä¸€ä¸ª IP åœ°å€ï¼Œç”¨ä½œæ ‡è¯†ã€‚é€šè¿‡ IP åœ°å€ï¼Œè®¾å¤‡é—´å¯ä»¥äº’ç›¸é€šè®¯ï¼Œå¦‚æœæ²¡æœ‰ IP åœ°å€ï¼Œæˆ‘ä»¬å°†æ— æ³•çŸ¥é“å“ªä¸ªè®¾å¤‡æ˜¯å‘é€æ–¹ï¼Œæ— æ³•çŸ¥é“å“ªä¸ªæ˜¯æ¥æ”¶æ–¹ã€‚IP åœ°å€æœ‰ä¸¤ä¸ªä¸»è¦åŠŸèƒ½ï¼šæ ‡è¯†è®¾å¤‡æˆ–ç½‘ç»œ å’Œ å¯»å€ï¼ˆè‹±è¯­ï¼šlocation addressingï¼‰ã€‚  
> å¸¸è§çš„ IP åœ°å€åˆ†ä¸º IPv4 ä¸ IPv6 ä¸¤å¤§ç±»ï¼ŒIP åœ°å€ç”±ä¸€ä¸²æ•°å­—ç»„æˆã€‚IPv4 ç”±åè¿›åˆ¶æ•°å­—ç»„æˆï¼Œå¹¶ä»¥ç‚¹åˆ†éš”ï¼Œå¦‚ï¼š`172.16.254.1`ï¼›IPv6 ç”±åå…­è¿›åˆ¶æ•°å­—ç»„æˆï¼Œä»¥å†’å·åˆ†å‰²ï¼Œå¦‚ï¼š`2001:db8:0:1234:0:567:8:1`ã€‚

> **ç«¯å£**æ˜¯æŒ‡é€»è¾‘æ„ä¹‰ä¸Šç”¨äºåŒºåˆ†æœåŠ¡çš„ç«¯å£ï¼Œæ¯”å¦‚ç”¨äºæµè§ˆç½‘é¡µæœåŠ¡çš„ 80 ç«¯å£ï¼Œç”¨äº FTP æœåŠ¡çš„ 21 ç«¯å£ç­‰ã€‚å¦‚ TCP/IP åè®®ä¸­çš„æœåŠ¡ç«¯å£ï¼Œé€šè¿‡ä¸åŒçš„é€»è¾‘ç«¯å£æ¥åŒºåˆ†ä¸åŒçš„æœåŠ¡ã€‚ä¸€ä¸ª IP åœ°å€çš„ç«¯å£é€šè¿‡ 16bit è¿›è¡Œç¼–å·ï¼Œæœ€å¤šå¯ä»¥æœ‰ 65536 ä¸ªç«¯å£ ã€‚ç«¯å£æ˜¯é€šè¿‡ç«¯å£å·æ¥æ ‡è®°çš„ï¼Œç«¯å£å·åªæœ‰æ•´æ•°ï¼ŒèŒƒå›´æ˜¯ä» 0 åˆ° 65535ã€‚

ä¸¾ä¸ªæ¯”æ–¹, ä½ è¦æ‰¾ä½ çš„å¿«é€’(_ä½ æ‰€éœ€è¦çš„å…·ä½“æœåŠ¡_), éœ€è¦é€šè¿‡åå­—(_ip_)å…ˆæ‰¾åˆ°ä»–çš„å¿«é€’ç«™ç‚¹, èœé¸Ÿ or ä¸­é€š or éŸµè¾¾(_æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡å™¨_), å†æ ¹æ®å–ä»¶ç (_ç«¯å£å·_)æ‰¾åˆ°ä½ çš„å¿«é€’(_å…·ä½“çš„æœåŠ¡_)

ç«¯å£å·çš„ä¸»è¦ä½œç”¨æ˜¯è¡¨ç¤ºä¸€å°è®¡ç®—æœºä¸­çš„ç‰¹å®šè¿›ç¨‹æ‰€æä¾›çš„æœåŠ¡ã€‚ç½‘ç»œä¸­çš„è®¡ç®—æœºæ˜¯é€šè¿‡ IP åœ°å€æ¥ä»£è¡¨å…¶èº«ä»½çš„ï¼Œå®ƒåªèƒ½è¡¨ç¤ºæŸå°ç‰¹å®šçš„è®¡ç®—æœºï¼Œä½†æ˜¯ä¸€å°è®¡ç®—æœºä¸Šå¯ä»¥åŒæ—¶æä¾›å¾ˆå¤šä¸ªæœåŠ¡ï¼Œå¦‚æ•°æ®åº“æœåŠ¡ã€FTP æœåŠ¡ã€Web æœåŠ¡ç­‰ï¼Œæˆ‘ä»¬å°±é€šè¿‡ç«¯å£å·æ¥åŒºåˆ«ç›¸åŒè®¡ç®—æœºæ‰€æä¾›çš„è¿™äº›ä¸åŒçš„æœåŠ¡ï¼Œå¦‚å¸¸è§çš„ç«¯å£å· 21 è¡¨ç¤ºçš„æ˜¯ FTP æœåŠ¡ï¼Œç«¯å£å· 23 è¡¨ç¤ºçš„æ˜¯ Telnet æœåŠ¡ç«¯å£å· 25 æŒ‡çš„æ˜¯ SMTP æœåŠ¡ç­‰ã€‚ç«¯å£å·ä¸€èˆ¬ä¹ æƒ¯ä¸º 4 ä½æ•´æ•°ï¼Œåœ¨åŒä¸€å°è®¡ç®—æœºä¸Šç«¯å£å·ä¸èƒ½é‡å¤ï¼Œå¦åˆ™ï¼Œå°±ä¼šäº§ç”Ÿç«¯å£å·å†²çªè¿™æ ·çš„ä¾‹å¤–

ok, è¯´äº†è¿™ä¹ˆå¤š, æˆ‘ä»¬æ¥å®æ“ä¸€ä¸‹

### æ‰¾ ip åœ°å€

```shell
ping 8.8.8.8            # å¯¹è°·æ­Œçš„æ€»æœåŠ¡è¯´ hi
ping www.baidu.com      # å¯¹è¾£é¸¡ç™¾åº¦è¯´ hi, ç­‰ä»·äº `ping 182.61.200.6`
```

### æ‰¾ç«¯å£å·

1. `telenet`

```shell
telnet www.baidu.com 80     # æŸ¥çœ‹ç™¾åº¦çš„ 80 ç«¯å£æ˜¯å¦æ‰“å¼€
telnet www.baidu.com 99     # æŸ¥çœ‹ç™¾åº¦çš„ 99 ç«¯å£æ˜¯å¦æ‰“å¼€
telnet xiong35.cn 99        # æŸ¥çœ‹æˆ‘æœåŠ¡å™¨çš„ 99 ç«¯å£æ˜¯å¦æ‰“å¼€
```

2. æµè§ˆå™¨åœ°å€æ åˆ†åˆ«è¾“å…¥`https://www.baidu.com:80/`å’Œ`https://www.baidu.com:90/`, å‰è€…æ‰¾åˆ°äº†ç™¾åº¦, åè€…ç‚¸äº†

### ç¼–å†™å…·ä½“çš„æœåŠ¡

1. hello node

```js
const http = require("http");
const url = require("url");

var server = http.createServer(function (req, res) {
  console.log(new Date().toISOString(), "\t", req.method, "\t", req.url);

  let urlPath = url.parse(req.url).pathname;
  res.writeHead(200);
  res.end(`
hello, there
you are accessing http://xiong35.cn${urlPath}
`);
});

server.listen("7777");
console.log(`Server running at port: 7777`);
```

2. è¿”å› html!

```js
res.end(`
<h1>WOW</h1>
<p>IT'S HTML !!!</p>
`);
```

3.  è¿”å›ä¸€ä¸ªå®Œæ•´çš„ç½‘é¡µ!!!!

```js
res.setHeader("Content-Type", "text/html;charset=utf-8");
res.end(`
<style>
  body {
    background-color: pink;
  }
  input {
    margin: 5vh auto;
    width: 300px;
    display: block;
  }
  button {
    display: inline-block;
    margin: auto;
    display: block;
  }
  p {
    margin: 20vh auto 5vh;
    text-align: center;
  }
</style>

<p>ä½ å¥½, ä»Šå¤©ä½ çš„è¿åŠ¿æ˜¯${~~(Math.random() * 100)}</p>
<input type="text" id="ipt" placeholder="è¾“å…¥ä½ æƒ³å»åˆ°å“ªä¸ªç½‘ç«™" />
<button id="submit">æäº¤</button>

<script>
  let inputContent = "";
  window.onload = function () {
    ipt.addEventListener("change", function (e) {
      inputContent = e.target.value;
    });

    submit.addEventListener("click", function (e) {
      window.location.href = inputContent;
    });
  };
</script>
`);
```

### è¿™ä¹ˆå†™å¤ªè¦å‘½äº†, æœ‰æ²¡æœ‰ç‰›ä¸€ç‚¹çš„å†™æ³•!

æœ‰! æœ‰ä¸€äº›äººå—ä¸äº†è¿™ç§å†™æ³•, å¯¹ä¸Šè¿° http æ¨¡å—åšäº†å°è£…, èƒ½å¤Ÿä»¥æ›´ç®€æ´çš„æ–¹å¼è°ƒç”¨å…¶åŠŸèƒ½, ç„¶åæŠŠä»–ä»¬çš„ä»£ç å…¬å¼€å‡ºæ¥ç»™å¤§å®¶ä¸‹è½½, å…¶ä¸­æœ€è‘—åçš„å°±æ˜¯ [koa](https://koajs.com/) å’Œ express

#### hello koa

```shell
mkdir hello-koa
cd hello-koa

npm init -y
npm install koa

vim index.js
```

```js
const Koa = require("koa");
const app = new Koa();

app.use(async (ctx) => {
  ctx.body = "<h1>Hello World, ä½ å¥½ä¸–ç•Œ</h1>";
});

app.listen(7777);
console.log("server running at 7777");
```

### å‰åç«¯åˆ†ç¦»

å‡è®¾ä½ æœ‰ä¸€äº›æ–°é—»æ•°æ®, æƒ³æŠŠå®ƒåšæˆä¸€ä¸ªæ–°é—»ç½‘ç«™:

```js
const news = [
  {
    title: "éœ‡æƒŠ! å¤©ç¿¼3gå±…ç„¶è¿™ä¹ˆå¿«!",
    time: "2008-7-12",
  },
  {
    title: "éœ‡æƒŠ! åä¸­ç§‘æŠ€å¤§å­¦ç­‰æ¥äº†å°ç†Š!",
    time: "2019-9-1",
  },
  {
    title: "éœ‡æƒŠ! çŸ¥åäº’è”ç½‘å›¢é˜Ÿå†…çš„æ¤…å­å±…ç„¶å…¨æ˜¯åçš„!",
    time: "2021-7-13",
  },
];
```

ç›´è§‰ä¸Šæ¥çœ‹, æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™:

```js
const Koa = require("koa");
const cors = require("@koa/cors");

const app = new Koa();
app.use(cors({ origin: "*" }));
app.use(async (ctx) => {
  const news = [
    {
      title: "éœ‡æƒŠ! å¤©ç¿¼3gå±…ç„¶è¿™ä¹ˆå¿«!",
      time: "2008-7-12",
    },
    {
      title: "éœ‡æƒŠ! åä¸­ç§‘æŠ€å¤§å­¦ç­‰æ¥äº†å°ç†Š!",
      time: "2019-9-1",
    },
    {
      title: "éœ‡æƒŠ! çŸ¥åäº’è”ç½‘å›¢é˜Ÿå†…çš„æ¤…å­å±…ç„¶å…¨æ˜¯åçš„!",
      time: "2021-7-13",
    },
  ];
  let newsStr = "";
  for (let i = 0; i < news.length; i++) {
    newsStr += `<li>${news[i].title}---${news[i].time}</li>`;
  }
  const newsBody = `<ul>${newsStr}</ul>`;
  ctx.body = newsBody;
});

app.listen(7777);
console.log("server running at 7777");
```

è¿™æ ·å›ºç„¶èƒ½å®Œæˆä»»åŠ¡, ä½†æ˜¯, è¿™æ ·å­—ç¬¦ä¸²æ‹¼æ¥å†™å‡ºæ¥çš„ä»£ç , ä¸€æ¥æ²¡æœ‰è¯­æ³•é«˜äº®, äºŒæ¥ä¸å¥½ç»´æŠ¤, ä¸æ˜¯å¾ˆä¼˜çš„æ–¹æ¡ˆ.

æˆ‘ä»¬å¯ä»¥è¿™æ ·:

åç«¯:

```js
const Koa = require("koa");
const app = new Koa();

app.use(async (ctx) => {
  const news = [
    {
      title: "éœ‡æƒŠ! å¤©ç¿¼3gå±…ç„¶è¿™ä¹ˆå¿«!",
      time: "2008-7-12",
    },
    {
      title: "éœ‡æƒŠ! åä¸­ç§‘æŠ€å¤§å­¦ç­‰æ¥äº†å°ç†Š!",
      time: "2019-9-1",
    },
    {
      title: "éœ‡æƒŠ! çŸ¥åäº’è”ç½‘å›¢é˜Ÿå†…çš„æ¤…å­å±…ç„¶å…¨æ˜¯åçš„!",
      time: "2021-7-13",
    },
  ];
  ctx.body = news;
});

app.listen(7777);
console.log("server running at 7777");
```

å‰ç«¯:

```html
<ul id="list"></ul>

<script>
  window.onload = function () {
    fetch("http://xiong35.cn:7777/")
      .then((_) => _.json())
      .then((res) => {
        console.log(res);
        res.forEach((r) => {
          const li = document.createElement("li");
          li.innerText = `${r.title}---${r.time}`;
          list.appendChild(li);
        });
      });
  };
</script>
```

è¿™æ ·å°±å®ç°äº†å‰åç«¯çš„è§£è€¦åˆ, è®©äºŒè€…èƒ½å„å¸å…¶èŒ, äº’ç›¸åˆä½œ, å…±åŒå®Œæˆå‡ºè‰²çš„ç½‘ç«™äº†!

## æ€»ç»“

å…ˆè¡Œçš„å‰åç«¯åˆ†ç¦»æ¨¡å¼ä¸‹, åç«¯è¦åšçš„ä»…ä»…æ˜¯æ ¹æ®å‰ç«¯å‘é€çš„ä¸åŒè¯·æ±‚, æŸ¥å‡ºæ•°æ®åº“é‡Œçš„æ•°æ®, å°†å…¶ä¼ åŒ–æˆ json æ ¼å¼è¿”å›ç»™å‰ç«¯, è‡³äºæ€ä¹ˆç”¨è¿™äº›æ•°æ®, æ¸²æŸ“åˆ°ä»€ä¹ˆåœ°æ–¹, è¿™éƒ½æ˜¯å‰ç«¯çš„å·¥ä½œ, å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥, è¿™éƒ½æ˜¯åç«¯çš„å·¥ä½œ.

ä½œä¸ºå‰ç«¯, å­¦ä¹ åç«¯çš„æ„ä¹‰åœ¨äº

1. é™ä½å‰åç«¯äº¤äº’çš„æ²Ÿé€šæˆæœ¬, ä»¥åä½ å’Œåˆ«äººåˆä½œä¸è‡³äºå¬ä¸æ‡‚ä»–åœ¨è¯´ä»€ä¹ˆ
2. éœ€è¦è‡ªå·±å®Œæˆå°é¡¹ç›®æ—¶, è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿ
3. ~~æ‹¿æ›´é«˜çš„ offer~~
4. ~~å…¨æ ˆçœ‹èµ·æ¥å°±å¾ˆç‰›é€¼å‘¢~~

æ­¤æ•™ç¨‹åªæ˜¯æŠ›ç –å¼•ç‰, åç«¯çš„çŸ¥è¯†åŒæ ·æ˜¯åšå¤§ç²¾æ·±çš„, éœ€è¦å¤§å®¶è‡ªå·±å¤šå­¦å¤šå†™.

<center><h2>å¹²å·´çˆ¹</h2></center>
